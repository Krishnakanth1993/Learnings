2025-09-28 15:03:30,431 - MNIST_Training - INFO - Logger initialized. Log file: C:\Users\krish\Documents\Krishnakanth\Learnings\Learnings\MNIST_Model\Reference\ERAS6\Model_Evolution\Fine_Tuning\logs\20250928_150330_mnist_training.log
2025-09-28 15:03:30,434 - MNIST_Training - INFO - Updated Configuration (from main()):
2025-09-28 15:03:30,434 - MNIST_Training - INFO -   - Epochs: 20
2025-09-28 15:03:30,436 - MNIST_Training - INFO -   - Learning Rate: 0.04
2025-09-28 15:03:30,436 - MNIST_Training - INFO -   - Optimizer: AdamW
2025-09-28 15:03:30,436 - MNIST_Training - INFO -   - Weight Decay: 0.0
2025-09-28 15:03:30,436 - MNIST_Training - INFO -   - Adam Betas: (0.9, 0.999)
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Adam Eps: 1e-08
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Scheduler: StepLR
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Step Size: 10
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Gamma: 0.1
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Batch Size: 64
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Num Workers: 4
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Pin Memory: True
2025-09-28 15:03:30,438 - MNIST_Training - INFO -   - Shuffle: True
2025-09-28 15:03:30,441 - MNIST_Training - INFO -   - Dropout Rate: 0.05
2025-09-28 15:03:30,443 - MNIST_Training - INFO -   - Device: CUDA
2025-09-28 15:03:30,443 - MNIST_Training - INFO -   - Log Directory: C:\Users\krish\Documents\Krishnakanth\Learnings\Learnings\MNIST_Model\Reference\ERAS6\Model_Evolution\Fine_Tuning\logs
2025-09-28 15:03:30,443 - MNIST_Training - INFO -   - Model Save Directory: C:\Users\krish\Documents\Krishnakanth\Learnings\Learnings\MNIST_Model\Reference\ERAS6\Model_Evolution\Fine_Tuning\models
2025-09-28 15:03:30,450 - MNIST_Training - INFO -   - Save Model: True
2025-09-28 15:03:30,473 - MNIST_Training - INFO -   - Log Level: DEBUG
2025-09-28 15:03:30,477 - MNIST_Training - INFO - ==================================================
2025-09-28 15:03:30,478 - MNIST_Training - INFO - ==================================================
2025-09-28 15:03:30,481 - MNIST_Training - INFO - MNIST TRAINING EXPERIMENT STARTED
2025-09-28 15:03:30,482 - MNIST_Training - INFO - ==================================================
2025-09-28 15:03:30,488 - MNIST_Training - INFO - Data Config: DataConfig(data_dir='./data', batch_size=64, num_workers=4, pin_memory=True, shuffle=True, mean=(0.1307,), std=(0.3081,), rotation_range=(-7.0, 7.0), fill_value=1)
2025-09-28 15:03:30,491 - MNIST_Training - INFO - Model Config: ModelConfig(input_channels=1, input_size=(28, 28), num_classes=10, dropout_rate=0.05)
2025-09-28 15:03:30,501 - MNIST_Training - INFO - Training Config: TrainingConfig(epochs=20, learning_rate=0.04, momentum=0.9, weight_decay=0.0, scheduler_step_size=10, scheduler_gamma=0.1, seed=1, optimizer_type='AdamW', adam_betas=(0.9, 0.999), adam_eps=1e-08, rmsprop_alpha=0.99, scheduler_type='StepLR', cosine_t_max=20, exponential_gamma=0.95, plateau_mode='min', plateau_factor=0.5, plateau_patience=5, plateau_threshold=0.0001)
2025-09-28 15:03:30,501 - MNIST_Training - INFO - ==================================================
2025-09-28 15:03:30,503 - MNIST_Training - INFO - Setting up data...
2025-09-28 15:03:30,503 - MNIST_Training - INFO - Loading MNIST dataset...
2025-09-28 15:03:30,616 - MNIST_Training - INFO - Dataset loaded successfully!
2025-09-28 15:03:30,616 - MNIST_Training - INFO - Train samples: 60000
2025-09-28 15:03:30,616 - MNIST_Training - INFO - Test samples: 10000
2025-09-28 15:03:30,616 - MNIST_Training - INFO - Computing data statistics...
2025-09-28 15:03:30,796 - MNIST_Training - INFO - Data Statistics:
2025-09-28 15:03:30,796 - MNIST_Training - INFO -   - Shape: torch.Size([60000, 28, 28])
2025-09-28 15:03:30,796 - MNIST_Training - INFO -   - Size: 47,040,000
2025-09-28 15:03:30,796 - MNIST_Training - INFO -   - Min: 0.0000
2025-09-28 15:03:30,796 - MNIST_Training - INFO -   - Max: 1.0000
2025-09-28 15:03:30,807 - MNIST_Training - INFO -   - Mean: 0.1307
2025-09-28 15:03:30,807 - MNIST_Training - INFO -   - Std: 0.3081
2025-09-28 15:03:30,807 - MNIST_Training - INFO -   - Variance: 0.0949
2025-09-28 15:03:42,085 - MNIST_Training - INFO - Batch Information:
2025-09-28 15:03:42,088 - MNIST_Training - INFO -   - Batch size: 64
2025-09-28 15:03:42,088 - MNIST_Training - INFO -   - Image shape: torch.Size([1, 28, 28])
2025-09-28 15:03:42,090 - MNIST_Training - INFO -   - Label shape: torch.Size([64])
2025-09-28 15:03:42,090 - MNIST_Training - INFO -   - Data type: torch.float32
2025-09-28 15:03:43,648 - MNIST_Training - INFO - Getting input size from data loader...
2025-09-28 15:03:53,811 - MNIST_Training - INFO - Input size from data loader: (1, 28, 28)
2025-09-28 15:03:55,575 - MNIST_Training - INFO - Setting up model...
2025-09-28 15:03:56,417 - MNIST_Training - INFO - Generating model summary...
2025-09-28 15:03:57,110 - MNIST_Training - INFO - Model Architecture Summary:
2025-09-28 15:03:57,110 - MNIST_Training - INFO -   - Total Parameters: 7,974
2025-09-28 15:03:57,110 - MNIST_Training - INFO -   - Batch Normalization: Yes
2025-09-28 15:03:57,110 - MNIST_Training - INFO -   - Dropout: Yes
2025-09-28 15:03:57,110 - MNIST_Training - INFO -   - GAP Layers: Yes
2025-09-28 15:03:57,110 - MNIST_Training - INFO -   - FC Layers: Yes
2025-09-28 15:03:57,110 - MNIST_Training - INFO - ==================================================
2025-09-28 15:03:57,110 - MNIST_Training - INFO - DETAILED MODEL ARCHITECTURE SUMMARY
2025-09-28 15:03:57,110 - MNIST_Training - INFO - ==================================================
2025-09-28 15:03:57,110 - MNIST_Training - INFO - ----------------------------------------------------------------
2025-09-28 15:03:57,110 - MNIST_Training - INFO -         Layer (type)               Output Shape         Param #
2025-09-28 15:03:57,110 - MNIST_Training - INFO - ================================================================
2025-09-28 15:03:57,110 - MNIST_Training - INFO -             Conv2d-1           [-1, 12, 28, 28]             108
2025-09-28 15:03:57,110 - MNIST_Training - INFO -        BatchNorm2d-2           [-1, 12, 28, 28]              24
2025-09-28 15:03:57,191 - MNIST_Training - INFO -               ReLU-3           [-1, 12, 28, 28]               0
2025-09-28 15:03:57,228 - MNIST_Training - INFO -             Conv2d-4           [-1, 12, 28, 28]           1,296
2025-09-28 15:03:57,238 - MNIST_Training - INFO -        BatchNorm2d-5           [-1, 12, 28, 28]              24
2025-09-28 15:03:57,263 - MNIST_Training - INFO -               ReLU-6           [-1, 12, 28, 28]               0
2025-09-28 15:03:57,281 - MNIST_Training - INFO -            Dropout-7           [-1, 12, 28, 28]               0
2025-09-28 15:03:57,297 - MNIST_Training - INFO -             Conv2d-8           [-1, 12, 28, 28]           1,296
2025-09-28 15:03:57,314 - MNIST_Training - INFO -        BatchNorm2d-9           [-1, 12, 28, 28]              24
2025-09-28 15:03:57,320 - MNIST_Training - INFO -              ReLU-10           [-1, 12, 28, 28]               0
2025-09-28 15:03:57,336 - MNIST_Training - INFO -           Dropout-11           [-1, 12, 28, 28]               0
2025-09-28 15:03:57,342 - MNIST_Training - INFO -         MaxPool2d-12           [-1, 12, 14, 14]               0
2025-09-28 15:03:57,346 - MNIST_Training - INFO -            Conv2d-13           [-1, 10, 14, 14]           1,080
2025-09-28 15:03:57,352 - MNIST_Training - INFO -       BatchNorm2d-14           [-1, 10, 14, 14]              20
2025-09-28 15:03:57,356 - MNIST_Training - INFO -              ReLU-15           [-1, 10, 14, 14]               0
2025-09-28 15:03:57,362 - MNIST_Training - INFO -           Dropout-16           [-1, 10, 14, 14]               0
2025-09-28 15:03:57,366 - MNIST_Training - INFO -            Conv2d-17           [-1, 10, 14, 14]             900
2025-09-28 15:03:57,370 - MNIST_Training - INFO -       BatchNorm2d-18           [-1, 10, 14, 14]              20
2025-09-28 15:03:57,374 - MNIST_Training - INFO -              ReLU-19           [-1, 10, 14, 14]               0
2025-09-28 15:03:57,384 - MNIST_Training - INFO -           Dropout-20           [-1, 10, 14, 14]               0
2025-09-28 15:03:57,384 - MNIST_Training - INFO -         MaxPool2d-21             [-1, 10, 7, 7]               0
2025-09-28 15:03:57,386 - MNIST_Training - INFO -            Conv2d-22             [-1, 16, 5, 5]           1,440
2025-09-28 15:03:57,386 - MNIST_Training - INFO -       BatchNorm2d-23             [-1, 16, 5, 5]              32
2025-09-28 15:03:57,386 - MNIST_Training - INFO -              ReLU-24             [-1, 16, 5, 5]               0
2025-09-28 15:03:57,391 - MNIST_Training - INFO -           Dropout-25             [-1, 16, 5, 5]               0
2025-09-28 15:03:57,392 - MNIST_Training - INFO -            Conv2d-26              [-1, 8, 3, 3]           1,152
2025-09-28 15:03:57,394 - MNIST_Training - INFO -       BatchNorm2d-27              [-1, 8, 3, 3]              16
2025-09-28 15:03:57,394 - MNIST_Training - INFO -              ReLU-28              [-1, 8, 3, 3]               0
2025-09-28 15:03:57,397 - MNIST_Training - INFO -           Dropout-29              [-1, 8, 3, 3]               0
2025-09-28 15:03:57,399 - MNIST_Training - INFO -         AvgPool2d-30              [-1, 8, 1, 1]               0
2025-09-28 15:03:57,399 - MNIST_Training - INFO -            Linear-31                   [-1, 28]             252
2025-09-28 15:03:57,399 - MNIST_Training - INFO -            Linear-32                   [-1, 10]             290
2025-09-28 15:03:57,399 - MNIST_Training - INFO - ================================================================
2025-09-28 15:03:57,399 - MNIST_Training - INFO - Total params: 7,974
2025-09-28 15:03:57,399 - MNIST_Training - INFO - Trainable params: 7,974
2025-09-28 15:03:57,399 - MNIST_Training - INFO - Non-trainable params: 0
2025-09-28 15:03:57,399 - MNIST_Training - INFO - ----------------------------------------------------------------
2025-09-28 15:03:57,404 - MNIST_Training - INFO - Input size (MB): 0.00
2025-09-28 15:03:57,404 - MNIST_Training - INFO - Forward/backward pass size (MB): 0.95
2025-09-28 15:03:57,407 - MNIST_Training - INFO - Params size (MB): 0.03
2025-09-28 15:03:57,407 - MNIST_Training - INFO - Estimated Total Size (MB): 0.98
2025-09-28 15:03:57,410 - MNIST_Training - INFO - ----------------------------------------------------------------
2025-09-28 15:03:57,412 - MNIST_Training - INFO - ==================================================
2025-09-28 15:03:57,413 - MNIST_Training - INFO - Setting up trainer...
2025-09-28 15:03:57,421 - MNIST_Training - INFO - Using device: cuda
2025-09-28 15:03:57,421 - MNIST_Training - INFO - Starting training process...
2025-09-28 15:03:57,424 - MNIST_Training - INFO - Starting training process...
2025-09-28 15:03:57,424 - MNIST_Training - INFO - Using optimizer: AdamW
2025-09-28 15:03:57,424 - MNIST_Training - INFO - Using scheduler: StepLR
2025-09-28 15:03:57,424 - MNIST_Training - INFO - Optimizer Configuration:
2025-09-28 15:03:57,424 - MNIST_Training - INFO -   - Learning Rate: 0.04
2025-09-28 15:03:57,424 - MNIST_Training - INFO -   - Betas: (0.9, 0.999)
2025-09-28 15:03:57,424 - MNIST_Training - INFO -   - Eps: 1e-08
2025-09-28 15:03:57,424 - MNIST_Training - INFO -   - Weight Decay: 0.0
2025-09-28 15:03:57,424 - MNIST_Training - INFO - Scheduler Configuration:
2025-09-28 15:03:57,424 - MNIST_Training - INFO -   - Step Size: 10
2025-09-28 15:03:57,424 - MNIST_Training - INFO -   - Gamma: 0.1
2025-09-28 15:03:57,424 - MNIST_Training - INFO - Starting Epoch 1/20
2025-09-28 15:04:46,898 - MNIST_Training - INFO - Epoch  1: Train Loss: 0.2655, Train Acc: 91.77%, Test Loss: 0.0730, Test Acc: 97.56%, LR: 0.040000
2025-09-28 15:04:46,898 - MNIST_Training - INFO - Starting Epoch 2/20
2025-09-28 15:05:32,358 - MNIST_Training - INFO - Epoch  2: Train Loss: 0.1190, Train Acc: 96.47%, Test Loss: 0.0786, Test Acc: 97.56%, LR: 0.040000
2025-09-28 15:05:32,360 - MNIST_Training - INFO - Starting Epoch 3/20
2025-09-28 15:06:26,760 - MNIST_Training - INFO - Epoch  3: Train Loss: 0.0965, Train Acc: 97.19%, Test Loss: 0.0533, Test Acc: 98.38%, LR: 0.040000
2025-09-28 15:06:26,760 - MNIST_Training - INFO - Starting Epoch 4/20
2025-09-28 15:07:14,880 - MNIST_Training - INFO - Epoch  4: Train Loss: 0.0949, Train Acc: 97.36%, Test Loss: 0.0486, Test Acc: 98.59%, LR: 0.040000
2025-09-28 15:07:14,880 - MNIST_Training - INFO - Starting Epoch 5/20
2025-09-28 15:08:04,078 - MNIST_Training - INFO - Epoch  5: Train Loss: 0.0843, Train Acc: 97.63%, Test Loss: 0.0478, Test Acc: 98.64%, LR: 0.040000
2025-09-28 15:08:04,078 - MNIST_Training - INFO - Starting Epoch 6/20
2025-09-28 15:08:58,745 - MNIST_Training - INFO - Epoch  6: Train Loss: 0.0840, Train Acc: 97.69%, Test Loss: 0.0559, Test Acc: 98.28%, LR: 0.040000
2025-09-28 15:08:58,747 - MNIST_Training - INFO - Starting Epoch 7/20
2025-09-28 15:09:46,707 - MNIST_Training - INFO - Epoch  7: Train Loss: 0.0805, Train Acc: 97.83%, Test Loss: 0.0448, Test Acc: 98.71%, LR: 0.040000
2025-09-28 15:09:46,707 - MNIST_Training - INFO - Starting Epoch 8/20
2025-09-28 15:10:31,881 - MNIST_Training - INFO - Epoch  8: Train Loss: 0.0749, Train Acc: 97.94%, Test Loss: 0.0537, Test Acc: 98.56%, LR: 0.040000
2025-09-28 15:10:31,881 - MNIST_Training - INFO - Starting Epoch 9/20
2025-09-28 15:11:15,297 - MNIST_Training - INFO - Epoch  9: Train Loss: 0.0749, Train Acc: 97.98%, Test Loss: 0.0434, Test Acc: 98.74%, LR: 0.040000
2025-09-28 15:11:15,297 - MNIST_Training - INFO - Starting Epoch 10/20
2025-09-28 15:12:03,266 - MNIST_Training - INFO - Epoch 10: Train Loss: 0.0736, Train Acc: 97.96%, Test Loss: 0.0461, Test Acc: 98.71%, LR: 0.004000
2025-09-28 15:12:03,275 - MNIST_Training - INFO - Starting Epoch 11/20
2025-09-28 15:12:50,501 - MNIST_Training - INFO - Epoch 11: Train Loss: 0.0449, Train Acc: 98.71%, Test Loss: 0.0270, Test Acc: 99.24%, LR: 0.004000
2025-09-28 15:12:50,501 - MNIST_Training - INFO - Starting Epoch 12/20
2025-09-28 15:13:34,660 - MNIST_Training - INFO - Epoch 12: Train Loss: 0.0385, Train Acc: 98.92%, Test Loss: 0.0248, Test Acc: 99.30%, LR: 0.004000
2025-09-28 15:13:34,660 - MNIST_Training - INFO - Starting Epoch 13/20
2025-09-28 15:14:19,637 - MNIST_Training - INFO - Epoch 13: Train Loss: 0.0355, Train Acc: 98.97%, Test Loss: 0.0234, Test Acc: 99.36%, LR: 0.004000
2025-09-28 15:14:19,637 - MNIST_Training - INFO - Starting Epoch 14/20
2025-09-28 15:15:06,846 - MNIST_Training - INFO - Epoch 14: Train Loss: 0.0357, Train Acc: 98.96%, Test Loss: 0.0264, Test Acc: 99.24%, LR: 0.004000
2025-09-28 15:15:06,846 - MNIST_Training - INFO - Starting Epoch 15/20
2025-09-28 15:15:54,267 - MNIST_Training - INFO - Epoch 15: Train Loss: 0.0328, Train Acc: 99.01%, Test Loss: 0.0233, Test Acc: 99.32%, LR: 0.004000
2025-09-28 15:15:54,267 - MNIST_Training - INFO - Starting Epoch 16/20
2025-09-28 15:16:43,241 - MNIST_Training - INFO - Epoch 16: Train Loss: 0.0344, Train Acc: 99.00%, Test Loss: 0.0227, Test Acc: 99.35%, LR: 0.004000
2025-09-28 15:16:43,243 - MNIST_Training - INFO - Starting Epoch 17/20
2025-09-28 15:17:25,362 - MNIST_Training - INFO - Epoch 17: Train Loss: 0.0333, Train Acc: 99.00%, Test Loss: 0.0236, Test Acc: 99.30%, LR: 0.004000
2025-09-28 15:17:25,362 - MNIST_Training - INFO - Starting Epoch 18/20
2025-09-28 15:18:07,432 - MNIST_Training - INFO - Epoch 18: Train Loss: 0.0331, Train Acc: 99.03%, Test Loss: 0.0208, Test Acc: 99.33%, LR: 0.004000
2025-09-28 15:18:07,432 - MNIST_Training - INFO - Starting Epoch 19/20
2025-09-28 15:18:53,395 - MNIST_Training - INFO - Epoch 19: Train Loss: 0.0318, Train Acc: 99.03%, Test Loss: 0.0218, Test Acc: 99.34%, LR: 0.004000
2025-09-28 15:18:53,395 - MNIST_Training - INFO - Starting Epoch 20/20
2025-09-28 15:19:38,208 - MNIST_Training - INFO - Epoch 20: Train Loss: 0.0337, Train Acc: 99.00%, Test Loss: 0.0227, Test Acc: 99.33%, LR: 0.000400
2025-09-28 15:19:38,208 - MNIST_Training - INFO - Training completed!
2025-09-28 15:19:38,208 - MNIST_Training - INFO - Final Results: {'final_train_loss': 0.03370902935472522, 'final_test_loss': 0.02266171283321455, 'final_train_accuracy': 99.00166666666667, 'final_test_accuracy': 99.33, 'best_test_accuracy': 99.36}
2025-09-28 15:19:41,567 - MNIST_Training - INFO - Training curves saved to: C:\Users\krish\Documents\Krishnakanth\Learnings\Learnings\MNIST_Model\Reference\ERAS6\Model_Evolution\Fine_Tuning\logs\training_curves_20250928_151938.png
2025-09-28 15:19:46,670 - MNIST_Training - INFO - Model saved to: C:\Users\krish\Documents\Krishnakanth\Learnings\Learnings\MNIST_Model\Reference\ERAS6\Model_Evolution\Fine_Tuning\models\mnist_model_20250928_151946.pth
2025-09-28 15:19:46,670 - MNIST_Training - INFO - ==================================================
2025-09-28 15:19:46,675 - MNIST_Training - INFO - TRAINING PIPELINE COMPLETED SUCCESSFULLY
2025-09-28 15:19:46,675 - MNIST_Training - INFO - ==================================================
2025-09-28 15:19:46,675 - MNIST_Training - INFO - Final Metrics: {'final_train_loss': 0.03370902935472522, 'final_test_loss': 0.02266171283321455, 'final_train_accuracy': 99.00166666666667, 'final_test_accuracy': 99.33, 'best_test_accuracy': 99.36}
